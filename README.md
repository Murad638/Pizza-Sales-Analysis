# PIZZA SALES Analysis

## Schema overview

![234453942-3df6eb5c-52cb-4386-a385-bec29cd8e060 (1)](https://github.com/user-attachments/assets/c7c10a2c-926c-4858-93e4-78a33a41bc5e)


## Task Objective

Your task is to perform an in-depth SQL data analysis on a pizza sales database.
The goal is to uncover meaningful insights from the dataset by writing a series of
SQL queries. This project will test your ability to craft complex queries, perform
aggregations, and extract valuable information from a relational database.
# Question set 1
1. Retrieve the total number of orders placed.
2. Calculate the total revenue generated from pizza sales.
3. Identify the highest-priced pizza.
4. Identify the most common pizza size ordered.
5. List the top 5 most ordered pizza types along with their quantities.
# Question set 2
1. Join the necessary tables to find the total quantity of each pizza category
ordered.
2. Determine the distribution of orders by hour of the day.
3. Join relevant tablesto find the category-wise distribution of pizzas.
4. Group the orders by date and calculate the average number of pizzas
ordered per day.
5. Determine the top 3 most ordered pizza types based on revenue.
# Question set 3
1. Calculate the percentage contribution of each pizza type to total revenue.
2. Analyze the cumulative revenue generated over time.
3. Calculate the 3-month moving average of monthly revenue.
4. Rank customers based on the total amount they have spent.
5. Calculate the percentile rank of each pizza type based on the total quantity
sold.
6. Determine the top 3 most ordered pizza types based on revenue for each
pizza category.
7. Compare each month's revenue to the previous month's revenue.
# Question set 4
1. Determine the average, minimum, and maximum order value per customer,
and identify the top 5 customers with the highest average order value.
2. Calculate the total revenue and the average revenue per pizza type over
each month.
3. Identify the top 3 pizza types in terms of quantity ordered within each city
and the respective revenue generated by these pizza types.
4. Determine the monthly cumulative revenue and the moving average of the
monthly revenue over a 3-month window.
5. Identify potential data quality issues by finding orders where the total price
is significantly different from the sum of the line item prices (e.g.,
differences greater than 5%).
6. Optimize the performance of a query that retrieves the total number of
pizzas sold per customer by using appropriate indexing and query
restructuring.
